# HRender åŠŸèƒ½è¦†ç›–æ£€æŸ¥æ¸…å•

æœ¬æ–‡æ¡£å¯¹ç…§ [hrender](https://github.com/ecomfe/zrender) ä»“åº“ï¼Œæ£€æŸ¥ HudX çš„å®ç°è¦†ç›–æƒ…å†µã€‚

## âœ… å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

### 1. æ ¸å¿ƒæ¸²æŸ“å¼•æ“

#### Renderer
- âœ… `init()` - åˆå§‹åŒ–å®ä¾‹
- âœ… `add()` - æ·»åŠ å…ƒç´ 
- âœ… `remove()` - ç§»é™¤å…ƒç´ 
- âœ… `removeAll()` - ç§»é™¤æ‰€æœ‰å…ƒç´ 
- âœ… `getElementById()` - é€šè¿‡ ID è·å–å…ƒç´ 
- âœ… `getRoot()` - è·å–æ ¹ç»„
- âœ… `resize()` - è°ƒæ•´å¤§å°
- âœ… `refresh()` - åˆ·æ–°ç»˜åˆ¶
- âœ… `flush()` - ç«‹å³åˆ·æ–°ï¼ˆæ–°å¢ï¼‰
- âœ… `setBackgroundColor()` - è®¾ç½®èƒŒæ™¯è‰²ï¼ˆæ–°å¢ï¼‰
- âœ… `on()` / `off()` / `trigger()` - äº‹ä»¶ç³»ç»Ÿ
- âœ… `getWidth()` / `getHeight()` - è·å–å°ºå¯¸
- âœ… `dispose()` - é”€æ¯å®ä¾‹

#### Storage (Model å±‚)
- âœ… `addRoot()` - æ·»åŠ æ ¹ç»„
- âœ… `removeRoot()` - ç§»é™¤æ ¹ç»„
- âœ… `getRoots()` - è·å–æ‰€æœ‰æ ¹ç»„
- âœ… `getElementById()` - é€šè¿‡ ID æŸ¥æ‰¾å…ƒç´ 
- âœ… `updateElement()` - æ›´æ–°å…ƒç´ ï¼ˆè‡ªåŠ¨å¤„ç†å­å…ƒç´ ï¼‰
- âœ… `removeElement()` - ç§»é™¤å…ƒç´ ï¼ˆè‡ªåŠ¨å¤„ç†å­å…ƒç´ ï¼‰
- âœ… `iterate()` - éå†æ‰€æœ‰å…ƒç´ 
- âœ… `getElementsList()` - è·å–æ’åºåçš„å…ƒç´ åˆ—è¡¨
- âœ… `clear()` - æ¸…ç©ºæ‰€æœ‰å…ƒç´ 

#### Painter (View å±‚)
- âœ… Canvas åˆ›å»ºå’Œç®¡ç†
- âœ… é«˜ DPI æ”¯æŒï¼ˆdevicePixelRatioï¼‰
- âœ… è‡ªåŠ¨è°ƒæ•´å¤§å°ï¼ˆResizeObserverï¼‰
- âœ… è„æ ‡è®°æœºåˆ¶
- âœ… `requestAnimationFrame` æ‰¹é‡æ›´æ–°
- âœ… `paint()` - ç»˜åˆ¶æ‰€æœ‰å…ƒç´ 
- âœ… `markDirty()` - æ ‡è®°éœ€è¦é‡ç»˜
- âœ… `resize()` - è°ƒæ•´ç”»å¸ƒå¤§å°
- âœ… `getCanvas()` / `getContext()` - è·å–ç”»å¸ƒå’Œä¸Šä¸‹æ–‡
- âœ… `getWidth()` / `getHeight()` - è·å–å°ºå¯¸
- âœ… `dispose()` - é”€æ¯

#### Handler (Controller å±‚)
- âœ… é¼ æ ‡äº‹ä»¶å¤„ç†ï¼ˆmousedown, mousemove, mouseup, click, dblclick, contextmenu, wheelï¼‰
- âœ… è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼ˆtouchstart, touchmove, touchendï¼‰
- âœ… æ‹–æ‹½æ”¯æŒ
- âœ… æ‚¬åœæ£€æµ‹
- âœ… äº‹ä»¶å†’æ³¡ï¼ˆæ”¹è¿›ï¼‰
- âœ… åæ ‡è½¬æ¢
- âœ… `dispose()` - é”€æ¯

### 2. å›¾å½¢å…ƒç´ ç³»ç»Ÿ

#### Element åŸºç±»
- âœ… åŸºæœ¬å±æ€§ï¼ˆid, zlevel, z, silent, invisible, cursor, draggableï¼‰
- âœ… æ ·å¼ç³»ç»Ÿï¼ˆstyleï¼‰
- âœ… å½¢çŠ¶å±æ€§ï¼ˆshapeï¼‰
- âœ… å˜æ¢ç³»ç»Ÿï¼ˆtransformï¼‰
- âœ… è£å‰ªè·¯å¾„ï¼ˆclipPathï¼‰
- âœ… `attr()` - è®¾ç½®/è·å–å±æ€§
- âœ… `markRedraw()` / `clearDirty()` / `isDirty()` - è„æ ‡è®°
- âœ… `getBoundingRect()` - è·å–è¾¹ç•ŒçŸ©å½¢
- âœ… `contain()` - ç‚¹æ˜¯å¦åœ¨å…ƒç´ å†…
- âœ… `render()` - æ¸²æŸ“æ–¹æ³•
- âœ… `applyTransform()` - åº”ç”¨å˜æ¢
- âœ… `applyStyle()` - åº”ç”¨æ ·å¼
- âœ… äº‹ä»¶ç³»ç»Ÿï¼ˆç»§æ‰¿è‡ª Eventfulï¼‰

#### Group å®¹å™¨
- âœ… `add()` / `remove()` / `removeAll()` - å­å…ƒç´ ç®¡ç†
- âœ… `childAt()` / `childOfName()` - è·å–å­å…ƒç´ 
- âœ… `children()` / `childrenCount()` - å­å…ƒç´ åˆ—è¡¨
- âœ… `traverse()` - éå†å­å…ƒç´ 
- âœ… `getBoundingRect()` - ç»„åˆè¾¹ç•ŒçŸ©å½¢
- âœ… `contain()` - ç‚¹æ˜¯å¦åœ¨ç»„å†…
- âœ… `render()` - æ¸²æŸ“ç»„å’Œå­å…ƒç´ 

#### Shape å›¾å½¢å…ƒç´ 
- âœ… **Circle** - åœ†å½¢
- âœ… **Rect** - çŸ©å½¢ï¼ˆæ”¯æŒåœ†è§’ï¼‰
- âœ… **Line** - ç›´çº¿
- âœ… **Polyline** - æŠ˜çº¿
- âœ… **Polygon** - å¤šè¾¹å½¢
- âœ… **Arc** - åœ†å¼§
- âœ… **BezierCurve** - è´å¡å°”æ›²çº¿ï¼ˆäºŒæ¬¡å’Œä¸‰æ¬¡ï¼‰
- âœ… **Path** - SVG è·¯å¾„
- âœ… **Text** - æ–‡æœ¬
- âœ… **Sector** - æ‰‡å½¢ï¼ˆæ–°å¢ï¼‰
- âœ… **Image** - å›¾ç‰‡ï¼ˆæ–°å¢ï¼‰

### 3. åŠ¨ç”»ç³»ç»Ÿ

#### Animation
- âœ… å•å±æ€§åŠ¨ç”»
- âœ… æ”¯æŒåµŒå¥—å±æ€§è·¯å¾„
- âœ… å¤šç§ç¼“åŠ¨å‡½æ•°ï¼ˆlinear, quadratic, cubic, elasticï¼‰
- âœ… `start()` / `stop()` / `pause()` / `resume()` - æ§åˆ¶æ–¹æ³•
- âœ… `onUpdate` / `onComplete` å›è°ƒ

#### Animator
- âœ… å¤šåŠ¨ç”»ç®¡ç†
- âœ… `animate()` - åˆ›å»ºåŠ¨ç”»
- âœ… `stopAll()` / `pauseAll()` / `resumeAll()` - æ‰¹é‡æ§åˆ¶
- âœ… `getAnimationCount()` - è·å–åŠ¨ç”»æ•°é‡

### 4. äº‹ä»¶ç³»ç»Ÿ

#### Eventful Mixin
- âœ… `on()` - æ·»åŠ äº‹ä»¶ç›‘å¬
- âœ… `off()` - ç§»é™¤äº‹ä»¶ç›‘å¬
- âœ… `trigger()` - è§¦å‘äº‹ä»¶
- âœ… `isSilent()` - æ£€æŸ¥æ˜¯å¦æœ‰ç›‘å¬å™¨

### 5. å·¥å…·å‡½æ•°

#### æ€§èƒ½ä¼˜åŒ–
- âœ… **ObjectPool** - å¯¹è±¡æ± 
- âœ… **BatchUpdater** - æ‰¹é‡æ›´æ–°

#### æ•°å­¦å·¥å…·
- âœ… **matrix** - çŸ©é˜µè¿ç®—
  - âœ… `createIdentityMatrix()` - åˆ›å»ºå•ä½çŸ©é˜µ
  - âœ… `multiplyMatrix()` - çŸ©é˜µä¹˜æ³•
  - âœ… `applyMatrix()` - åº”ç”¨çŸ©é˜µåˆ°ç‚¹
  - âœ… `createTranslateMatrix()` - å¹³ç§»çŸ©é˜µ
  - âœ… `createScaleMatrix()` - ç¼©æ”¾çŸ©é˜µ
  - âœ… `createRotateMatrix()` - æ—‹è½¬çŸ©é˜µ
  - âœ… `invertMatrix()` - çŸ©é˜µæ±‚é€†

#### é¢œè‰²å·¥å…·
- âœ… **color** - é¢œè‰²å¤„ç†
  - âœ… `parseColor()` - è§£æé¢œè‰²å­—ç¬¦ä¸²
  - âœ… `rgbaToString()` - RGBA è½¬å­—ç¬¦ä¸²
  - âœ… `lighten()` - å˜äº®
  - âœ… `darken()` - å˜æš—
  - âœ… `adjustOpacity()` - è°ƒæ•´é€æ˜åº¦

## ğŸ“‹ ä¸ hrender çš„å¯¹æ¯”

### æ ¸å¿ƒæ¶æ„
- âœ… MVC æ¨¡å¼ï¼ˆStorage/Painter/Handlerï¼‰
- âœ… å…ƒç´ æ ‘ç»“æ„
- âœ… äº‹ä»¶ç³»ç»Ÿ
- âœ… åŠ¨ç”»ç³»ç»Ÿ
- âœ… è„æ ‡è®°æœºåˆ¶

### API å…¼å®¹æ€§
- âœ… ä¸»è¦ API æ–¹æ³•å·²å®ç°
- âœ… äº‹ä»¶ç³»ç»Ÿå…¼å®¹
- âœ… åŠ¨ç”»ç³»ç»Ÿå…¼å®¹
- âœ… å›¾å½¢å…ƒç´  API å…¼å®¹

### æ€§èƒ½ä¼˜åŒ–
- âœ… æ‰¹é‡æ›´æ–°ï¼ˆrequestAnimationFrameï¼‰
- âœ… è„æ ‡è®°
- âœ… é«˜ DPI æ”¯æŒ
- âœ… å¯¹è±¡æ± ï¼ˆæ–°å¢ï¼‰
- âœ… æ‰¹é‡æ›´æ–°å™¨ï¼ˆæ–°å¢ï¼‰

## ğŸ¯ é¢å¤–å¢å¼ºåŠŸèƒ½

HudX åœ¨ hrender åŸºç¡€ä¸Šæ·»åŠ äº†ä»¥ä¸‹å¢å¼ºï¼š

1. **TypeScript å®Œæ•´æ”¯æŒ** - æ‰€æœ‰ä»£ç éƒ½æœ‰å®Œæ•´çš„ç±»å‹å®šä¹‰
2. **React é›†æˆ** - æä¾› React ç»„ä»¶å°è£…
3. **å¯¹è±¡æ± ** - æ€§èƒ½ä¼˜åŒ–å·¥å…·
4. **æ‰¹é‡æ›´æ–°å™¨** - æ€§èƒ½ä¼˜åŒ–å·¥å…·
5. **é¢œè‰²å·¥å…·** - é¢œè‰²å¤„ç†å·¥å…·å‡½æ•°
6. **çŸ©é˜µå·¥å…·** - çŸ©é˜µè¿ç®—å·¥å…·å‡½æ•°
7. **Sector å›¾å½¢** - æ‰‡å½¢å…ƒç´ ï¼ˆç”¨äºé¥¼å›¾ç­‰ï¼‰
8. **Image å›¾å½¢** - å›¾ç‰‡å…ƒç´ 

## âœ… æ€»ç»“

HudX çš„æ ¸å¿ƒæ¸²æŸ“å¼•æ“ï¼ˆ@hudx/coreï¼‰å·²ç»**å®Œå…¨è¦†ç›–**äº† hrender çš„ä¸»è¦åŠŸèƒ½ï¼š

- âœ… æ‰€æœ‰æ ¸å¿ƒç±»å·²å®ç°
- âœ… æ‰€æœ‰ä¸»è¦ API å·²å®ç°
- âœ… å›¾å½¢å…ƒç´ ç³»ç»Ÿå®Œæ•´
- âœ… åŠ¨ç”»ç³»ç»Ÿå®Œæ•´
- âœ… äº‹ä»¶ç³»ç»Ÿå®Œæ•´
- âœ… æ€§èƒ½ä¼˜åŒ–æœºåˆ¶å®Œæ•´

åŒæ—¶ï¼ŒHudX è¿˜æä¾›äº†é¢å¤–çš„å¢å¼ºåŠŸèƒ½å’Œæ›´å¥½çš„ TypeScript æ”¯æŒï¼Œä½¿å…¶æ›´é€‚åˆç°ä»£ React + TypeScript é¡¹ç›®ã€‚

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ¸²æŸ“æ¨¡å¼**ï¼šHudX æ”¯æŒ Canvas å’Œ SVG ä¸¤ç§æ¸²æŸ“æ¨¡å¼
2. **å®ç°ç»†èŠ‚**ï¼šæŸäº›å†…éƒ¨å®ç°ç»†èŠ‚å¯èƒ½ä¸ hrender ç•¥æœ‰ä¸åŒï¼Œä½† API å’ŒåŠŸèƒ½ä¿æŒä¸€è‡´
3. **æ‰©å±•æ€§**ï¼šHudX çš„è®¾è®¡æ›´æ³¨é‡å¯æ‰©å±•æ€§å’Œç±»å‹å®‰å…¨

